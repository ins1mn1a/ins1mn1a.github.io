<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Zookeeper、Redis、Kafka集群搭建指令与集群搭建过程 | ins1mn1a</title><meta name="keywords" content="中间件指令与集群搭建过程"><meta name="author" content="ins1mnia"><meta name="copyright" content="ins1mnia"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Zookeeper、Redis、Kafka集群搭建">
<meta property="og:type" content="article">
<meta property="og:title" content="Zookeeper、Redis、Kafka集群搭建指令与集群搭建过程">
<meta property="og:url" content="http://ins1mn1a.github.io/2022/09/20/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%8C%87%E4%BB%A4%E4%B8%8E%E9%9B%86%E7%BE%A4/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%8C%87%E4%BB%A4%E6%95%B4%E7%90%86/index.html">
<meta property="og:site_name" content="ins1mn1a">
<meta property="og:description" content="Zookeeper、Redis、Kafka集群搭建">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://ins1mn1a.github.io/img/background_img/1/1.jpg">
<meta property="article:published_time" content="2022-09-20T04:44:31.833Z">
<meta property="article:modified_time" content="2022-09-20T04:46:56.238Z">
<meta property="article:author" content="ins1mnia">
<meta property="article:tag" content="中间件指令与集群搭建过程">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://ins1mn1a.github.io/img/background_img/1/1.jpg"><link rel="shortcut icon" href="/img/background_img/%E7%8E%89%E5%AD%90.icon.png"><link rel="canonical" href="http://ins1mn1a.github.io/2022/09/20/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%8C%87%E4%BB%A4%E4%B8%8E%E9%9B%86%E7%BE%A4/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%8C%87%E4%BB%A4%E6%95%B4%E7%90%86/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Zookeeper、Redis、Kafka集群搭建指令与集群搭建过程',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-09-20 12:46:56'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="ins1mn1a" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://tvax1.sinaimg.cn/crop.0.0.996.996.180/007RWaeLly8gr7p82e9e6j30ro0rognd.jpg?KID=imgbed,tva&amp;Expires=1639625304&amp;ssig=yn%2FY%2BCtxLO" onerror="onerror=null;src='/img/background_img/error_page.jpeg'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">35</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">14</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">13</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/background_img/1/1.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">ins1mn1a</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Zookeeper、Redis、Kafka集群搭建指令与集群搭建过程</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-09-20T04:44:31.833Z" title="发表于 2022-09-20 12:44:31">2022-09-20</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-09-20T04:46:56.238Z" title="更新于 2022-09-20 12:46:56">2022-09-20</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%8C%87%E4%BB%A4%E4%B8%8E%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA%E8%BF%87%E7%A8%8B/">中间件指令与集群搭建过程</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">8.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>38分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Zookeeper、Redis、Kafka集群搭建指令与集群搭建过程"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2022/09/20/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%8C%87%E4%BB%A4%E4%B8%8E%E9%9B%86%E7%BE%A4/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%8C%87%E4%BB%A4%E6%95%B4%E7%90%86/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count" data-xid="/2022/09/20/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%8C%87%E4%BB%A4%E4%B8%8E%E9%9B%86%E7%BE%A4/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%8C%87%E4%BB%A4%E6%95%B4%E7%90%86/" itemprop="commentCount"></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="Zookeeper"><a href="#Zookeeper" class="headerlink" title="Zookeeper"></a>Zookeeper</h2><h3 id="Znode-基本操作"><a href="#Znode-基本操作" class="headerlink" title="Znode 基本操作"></a>Znode 基本操作</h3><p>Znode 是 Zookeeper 的数据节点</p>
<ul>
<li><p>查看节点</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 展示路径下的Znode节点ls path</span></span><br><span class="line">ls path</span><br><span class="line"></span><br><span class="line">ls /</span><br><span class="line">ls /zookeeper</span><br></pre></td></tr></table></figure></li>
<li><p>创建节点</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 创建节点 -s 代表顺序节点 -e代表临时节点 -t ttl表示TTL类型节点，默认持久节点</span></span><br><span class="line">create [-s] [-e] [-c] [-t ttl] path [data] [acl]</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 在/下创建一个具有testnode1数据的testNode节点</span></span><br><span class="line">create /testNode testnode1</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 在a1节点下创建一个叫c1的持久节点</span></span><br><span class="line">create /a1/c1</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 创建临时节点</span></span><br><span class="line">create -e /a1/c1</span><br></pre></td></tr></table></figure></li>
<li><p>节点状态数据</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 获取某个节点的状态</span></span><br><span class="line">stat path</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置一个节点的数据</span></span><br><span class="line">set path data</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 获取a1节点下的c1数据 不支持同时创建多级目录</span></span><br><span class="line">get /a1/c1</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="Zookeeper-基本操作"><a href="#Zookeeper-基本操作" class="headerlink" title="Zookeeper 基本操作"></a>Zookeeper 基本操作</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 启动 Zookeeper</span></span><br><span class="line">[root@localhost bin]# ./zkServer.sh start</span><br><span class="line">ZooKeeper JMX enabled by default</span><br><span class="line">Using config: /root/zookeeper-3.4.13/bin/../conf/zoo.cfg</span><br><span class="line">Starting zookeeper ... STARTED</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 启动 Zookeeper 客户端</span></span><br><span class="line">[root@localhost bin]# ./zkCli.sh -server ip:port</span><br><span class="line">[zk: localhost:2181(CONNECTED) 0] help</span><br><span class="line">ZooKeeper -server host:port cmd args</span><br><span class="line">	stat path [watch]</span><br><span class="line">	set path data [version]</span><br><span class="line">	ls path [watch]</span><br><span class="line">	delquota [-n|-b] path</span><br><span class="line">	ls2 path [watch]</span><br><span class="line">	setAcl path acl</span><br><span class="line">	setquota -n|-b val path</span><br><span class="line">	history </span><br><span class="line">	redo cmdno</span><br><span class="line">	printwatches on|off</span><br><span class="line">	delete path [version]</span><br><span class="line">	sync path</span><br><span class="line">	listquota path</span><br><span class="line">	rmr path</span><br><span class="line">	get path [watch]</span><br><span class="line">	create [-s] [-e] path data acl</span><br><span class="line">	addauth scheme auth</span><br><span class="line">	quit </span><br><span class="line">	getAcl path</span><br><span class="line">	close </span><br><span class="line">	connect host:port</span><br></pre></td></tr></table></figure>

<h3 id="Zookeeper-集群"><a href="#Zookeeper-集群" class="headerlink" title="Zookeeper 集群"></a>Zookeeper 集群</h3><p>启动<strong>三台虚拟机</strong>搭建<strong>Zookeeper集群</strong>，Zookeeper集群中包含三个节点，三个节点的IP如下：</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">192.168.73.137</span></span><br><span class="line"><span class="attr">192.168.73.136</span></span><br><span class="line"><span class="attr">192.168.73.135</span></span><br></pre></td></tr></table></figure>

<ol>
<li>修改 三个 Zookeeper 节点的配置文件zoo.cfg</li>
</ol>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># The number of milliseconds of each tick</span></span><br><span class="line"><span class="attr">tickTime</span>=<span class="string">2000</span></span><br><span class="line"><span class="comment"># The number of ticks that the initial </span></span><br><span class="line"><span class="comment"># synchronization phase can take</span></span><br><span class="line"><span class="attr">initLimit</span>=<span class="string">10</span></span><br><span class="line"><span class="comment"># The number of ticks that can pass between </span></span><br><span class="line"><span class="comment"># sending a request and getting an acknowledgement</span></span><br><span class="line"><span class="attr">syncLimit</span>=<span class="string">5</span></span><br><span class="line"><span class="comment"># the directory where the snapshot is stored.</span></span><br><span class="line"><span class="comment"># do not use /tmp for storage, /tmp here is just </span></span><br><span class="line"><span class="comment"># example sakes.</span></span><br><span class="line"><span class="attr">dataDir</span>=<span class="string">/root/apache-zookeeper-3.7.0-bin/data</span></span><br><span class="line"><span class="comment"># the port at which the clients will connect</span></span><br><span class="line"><span class="attr">clientPort</span>=<span class="string">2181</span></span><br><span class="line"><span class="comment"># 集群配置</span></span><br><span class="line"><span class="comment"># 1 只是个服务器编号</span></span><br><span class="line"><span class="comment"># 192.168.73.137: zookeeper节点IP</span></span><br><span class="line"><span class="comment"># 2287: zookeeper集群相互通信的端口号</span></span><br><span class="line"><span class="comment"># 3387: Leader 选举的端口号</span></span><br><span class="line"><span class="meta">server.1</span>=<span class="string">192.168.73.137:2287:3387</span></span><br><span class="line"><span class="meta">server.2</span>=<span class="string">192.168.73.136:2287:3387</span></span><br><span class="line"><span class="meta">server.3</span>=<span class="string">192.168.73.135:2287:3387</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>在配置文件中 <code>dataDir </code>指定的目录下，创建<code>myid</code>文件，添加zookeeper对应的myid，myid 是 Zookeeper的服务器编号，用于选举的</li>
</ol>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">echo &quot;1&quot; &gt; myid</span><br></pre></td></tr></table></figure>

<ol start="3">
<li><code>./zkServer.sh start</code> 启动三台zookeeper，<code>./zkServer.sh status</code> 查看服务器状态</li>
</ol>
<h2 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h2><h3 id="Redis-基本操作"><a href="#Redis-基本操作" class="headerlink" title="Redis 基本操作"></a>Redis 基本操作</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 启动 Redis Server 其中 myredisconfig/redis.conf 是Redis配置文件的地址</span></span><br><span class="line">redis-server myredisconfig/redis.conf</span><br><span class="line"><span class="meta">#</span><span class="bash"> 启动 Redis 客户端 其中 -a 是密码，密码是 redis.conf 里面的配置 requirepass password</span></span><br><span class="line">redis-cli -h 127.0.0.1 -p 6379 -a mypassword</span><br><span class="line"><span class="meta">#</span><span class="bash"> 关闭 Redis 在客户端下 shutdown 可以关闭 Redis</span></span><br><span class="line">shutdown</span><br><span class="line"><span class="meta">#</span><span class="bash"> redis-benchmark 官方自带的性能测试</span></span><br><span class="line">redis-benchmark -h localhost -p 6379 -c 100 -n 100000</span><br></pre></td></tr></table></figure>

<h3 id="Redis-数据类型操作"><a href="#Redis-数据类型操作" class="headerlink" title="Redis 数据类型操作"></a>Redis 数据类型操作</h3><h4 id="Redis-key"><a href="#Redis-key" class="headerlink" title="Redis key"></a>Redis key</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; keys *	# 查看所有的key</span><br><span class="line">(empty array)</span><br><span class="line">localhost:6379&gt; set name redis	# 设置key</span><br><span class="line">OK</span><br><span class="line">localhost:6379&gt; keys *</span><br><span class="line">1) &quot;name&quot;</span><br><span class="line">localhost:6379&gt; set age 20</span><br><span class="line">OK</span><br><span class="line">localhost:6379&gt; keys *</span><br><span class="line">1) &quot;age&quot;</span><br><span class="line">2) &quot;name&quot;</span><br><span class="line">localhost:6379&gt; exist name</span><br><span class="line">(error) ERR unknown command `exist`, with args beginning with: `name`,</span><br><span class="line">localhost:6379&gt; exists name	# 判断key是否存在</span><br><span class="line">(integer) 1</span><br><span class="line">localhost:6379&gt; get name</span><br><span class="line">&quot;redis&quot;</span><br><span class="line">localhost:6379&gt; expire name 10	# 设置key的过期时间 可用于热点数据或者单点登录等</span><br><span class="line">(integer) 1</span><br><span class="line">localhost:6379&gt; ttl name	# 查看key的过期时间</span><br><span class="line">(integer) 7</span><br><span class="line">localhost:6379&gt; ttl name</span><br><span class="line">(integer) 6</span><br><span class="line">localhost:6379&gt; ttl name</span><br><span class="line">(integer) 3</span><br><span class="line">localhost:6379&gt; ttl name	# key 过期</span><br><span class="line">(integer) -2</span><br><span class="line">localhost:6379&gt; type name</span><br><span class="line">none</span><br><span class="line">localhost:6379&gt; keys *</span><br><span class="line">1) &quot;age&quot;</span><br><span class="line">localhost:6379&gt; type age	# 查看key的类型</span><br><span class="line">string</span><br></pre></td></tr></table></figure>

<h4 id="String"><a href="#String" class="headerlink" title="String"></a>String</h4><p><code>append key value</code>：在指定key的字符串value后面追加一个value</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; set key1 hello # 设置key1为hello</span><br><span class="line">OK</span><br><span class="line">localhost:6379&gt; append key1 ,redis # 在指定key的字符串value后面追加一个value</span><br><span class="line">(integer) 11</span><br><span class="line">localhost:6379&gt; get key1</span><br><span class="line">&quot;hello,redis&quot;</span><br><span class="line">localhost:6379&gt; append key1 &quot;redis1&quot;</span><br><span class="line">(integer) 17</span><br><span class="line">localhost:6379&gt; get key1</span><br><span class="line">&quot;hello,redisredis1&quot;</span><br><span class="line">localhost:6379&gt; append key2 myredis # 如果原来没key 则相当于set</span><br><span class="line">(integer) 7</span><br><span class="line">localhost:6379&gt; get key2</span><br><span class="line">&quot;myredis&quot;</span><br></pre></td></tr></table></figure>

<p><code>strlen key</code>：获取指定的长度</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; strlen key1</span><br><span class="line">(integer) 17</span><br><span class="line">localhost:6379&gt; strlen key2</span><br><span class="line">(integer) 7</span><br></pre></td></tr></table></figure>

<p><code>incr/decr key</code>：将指定的key的value加1/减1</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; incr views</span><br><span class="line">(integer) 1</span><br><span class="line">localhost:6379&gt; incr views</span><br><span class="line">(integer) 2</span><br><span class="line">localhost:6379&gt; decr views</span><br><span class="line">(integer) 1</span><br><span class="line">localhost:6379&gt; decr views</span><br><span class="line">(integer) 0</span><br></pre></td></tr></table></figure>

<p><code>incrby/decrby key increment/decrement </code>：把指定key的value加/减一个increment/decrement</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; decr views</span><br><span class="line">(integer) 1</span><br><span class="line">localhost:6379&gt; decr views</span><br><span class="line">(integer) 0</span><br><span class="line">localhost:6379&gt; decr views</span><br><span class="line">(integer) -1</span><br><span class="line">localhost:6379&gt; incrby views 10</span><br><span class="line">(integer) 9</span><br><span class="line">localhost:6379&gt; incrby views 10</span><br><span class="line">(integer) 19</span><br><span class="line">localhost:6379&gt; decrby views 9</span><br><span class="line">(integer) 10</span><br><span class="line">localhost:6379&gt; decrby views 10</span><br><span class="line">(integer) 0</span><br></pre></td></tr></table></figure>

<p><code>getrange key start end</code>：根据key获取指定下标范围 [start，end] 的value</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; get key2</span><br><span class="line">&quot;myredis&quot;</span><br><span class="line">localhost:6379&gt; getrange key2 0 3</span><br><span class="line">&quot;myre&quot;</span><br><span class="line">localhost:6379&gt; getrange key2 0 -1 # -1表示字符串尾</span><br><span class="line">&quot;myredis&quot;</span><br></pre></td></tr></table></figure>

<p> <code>setrange key offset value</code>：根据key从指定下标 offset 索引位置开始设置value</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; get key2</span><br><span class="line">&quot;myredis&quot;</span><br><span class="line">localhost:6379&gt; setrange key2 2 **</span><br><span class="line">(integer) 7</span><br><span class="line">localhost:6379&gt; get key2</span><br><span class="line">&quot;my**dis&quot;</span><br></pre></td></tr></table></figure>

<p><code>setex key seconds value </code>：设置key value的同时设置超时时间</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; setex key1 30 &quot;hello&quot;</span><br><span class="line">OK</span><br><span class="line">localhost:6379&gt; ttl key1</span><br><span class="line">(integer) 26</span><br></pre></td></tr></table></figure>

<p> <code>setnx key value</code>：如果key 不存在，则设置为value；如果key已经存在，则不变</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; setnx key2 <span class="string">&quot;redis&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">localhost:6379&gt; get key2</span><br><span class="line"><span class="string">&quot;redis&quot;</span></span><br><span class="line">localhost:6379&gt; setnx key2 <span class="string">&quot;hello&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">localhost:6379&gt; get key2</span><br><span class="line"><span class="string">&quot;redis&quot;</span></span><br></pre></td></tr></table></figure>

<p> <code>mset key1 value1 key2 value2 ...</code>：批量设置多个key-value</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; mset k1 v1 k2 v2 k3 v3</span><br><span class="line">OK</span><br><span class="line">localhost:6379&gt; keys *</span><br><span class="line">1) <span class="string">&quot;k2&quot;</span></span><br><span class="line">2) <span class="string">&quot;k1&quot;</span></span><br><span class="line">3) <span class="string">&quot;k3&quot;</span></span><br></pre></td></tr></table></figure>

<p><code>mget key1 key2 key3 ...</code>：批量获取多个key的value</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; mget k1 k2 k3</span><br><span class="line">1) <span class="string">&quot;v1&quot;</span></span><br><span class="line">2) <span class="string">&quot;v2&quot;</span></span><br><span class="line">3) <span class="string">&quot;v3&quot;</span></span><br><span class="line">localhost:6379&gt; mget k1 k2 k3 k4</span><br><span class="line">1) <span class="string">&quot;v1&quot;</span></span><br><span class="line">2) <span class="string">&quot;v2&quot;</span></span><br><span class="line">3) <span class="string">&quot;v3&quot;</span></span><br><span class="line">4) (nil)</span><br></pre></td></tr></table></figure>

<p><code>msetnx key1 value1 key2 value ...</code>：批量set if not exist，只要一个失败，那么都会失败。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; mget k1 k2 k3 k4</span><br><span class="line">1) <span class="string">&quot;v1&quot;</span></span><br><span class="line">2) <span class="string">&quot;v2&quot;</span></span><br><span class="line">3) <span class="string">&quot;v3&quot;</span></span><br><span class="line">4) (nil)</span><br><span class="line">localhost:6379&gt; msetnx k1 value1 k5 k5 <span class="comment"># 不存在则设置，k1已存在 set失败 后续也不能成功</span></span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">localhost:6379&gt; get k5</span><br><span class="line">(nil)</span><br><span class="line">localhost:6379&gt; msetnx k5 k5 k1 value1</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">localhost:6379&gt; get k5</span><br><span class="line">(nil)</span><br></pre></td></tr></table></figure>

<p> <code>getset key value</code></p>
<p>如果不存在值，则返回空（nil）；如果存在值，则先返回当前值，然后再设置新值。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; getset key1 <span class="string">&quot;redis&quot;</span></span><br><span class="line">(nil)</span><br><span class="line">localhost:6379&gt; get key1</span><br><span class="line"><span class="string">&quot;redis&quot;</span></span><br><span class="line">localhost:6379&gt; get k1</span><br><span class="line"><span class="string">&quot;value1&quot;</span></span><br><span class="line">localhost:6379&gt; getset k1 v1</span><br><span class="line"><span class="string">&quot;value1&quot;</span></span><br><span class="line">localhost:6379&gt; get k1</span><br><span class="line"><span class="string">&quot;v1&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="List"><a href="#List" class="headerlink" title="List"></a>List</h4><p>List 特别灵活，如果Lpush Rpop 那么它就是一个队列；如果Lpush Lpop就是一个栈。List中可以存重复的值。</p>
<p> <code>lpush list element</code>：可以理解为在列表的头部插入值。lpush相当于一个入栈操作，先进后出。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; lpush list one</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">localhost:6379&gt; lpush list two</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">localhost:6379&gt; lpush list three</span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">localhost:6379&gt; lrange list 0 -1</span><br><span class="line">1) <span class="string">&quot;three&quot;</span></span><br><span class="line">2) <span class="string">&quot;two&quot;</span></span><br><span class="line">3) <span class="string">&quot;one&quot;</span></span><br></pre></td></tr></table></figure>

<p> <code>rpush list element</code>：可以理解为在list尾部插入数据。rpush相当于队列操作，先进的先出。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; rpush list four</span><br><span class="line">(<span class="built_in">integer</span>) 4</span><br><span class="line">localhost:6379&gt; rpush list five</span><br><span class="line">(<span class="built_in">integer</span>) 5</span><br><span class="line">localhost:6379&gt; lrange list 0 -1</span><br><span class="line">1) <span class="string">&quot;three&quot;</span></span><br><span class="line">2) <span class="string">&quot;two&quot;</span></span><br><span class="line">3) <span class="string">&quot;one&quot;</span></span><br><span class="line">4) <span class="string">&quot;four&quot;</span></span><br><span class="line">5) <span class="string">&quot;five&quot;</span></span><br></pre></td></tr></table></figure>

<p><code>lpop key [count]</code>：可以理解为每次删除并返回第一个数。跟lpush对应，栈第一个数据弹出</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; lrange list 0 -1</span><br><span class="line">1) <span class="string">&quot;three&quot;</span></span><br><span class="line">2) <span class="string">&quot;two&quot;</span></span><br><span class="line">3) <span class="string">&quot;one&quot;</span></span><br><span class="line">4) <span class="string">&quot;four&quot;</span></span><br><span class="line">5) <span class="string">&quot;five&quot;</span></span><br><span class="line">localhost:6379&gt; lpop list</span><br><span class="line"><span class="string">&quot;three&quot;</span></span><br></pre></td></tr></table></figure>

<p><code>rpop key [count]</code>：可以理解为每次删除并返回最后一个数。跟rpush对应，队列第一个数据出队</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; lpop list</span><br><span class="line"><span class="string">&quot;three&quot;</span></span><br><span class="line">localhost:6379&gt; rpop list</span><br><span class="line"><span class="string">&quot;five&quot;</span></span><br><span class="line">localhost:6379&gt; lrange list 0 -1</span><br><span class="line">1) <span class="string">&quot;two&quot;</span></span><br><span class="line">2) <span class="string">&quot;one&quot;</span></span><br><span class="line">3) <span class="string">&quot;four&quot;</span></span><br></pre></td></tr></table></figure>

<p> <code>lindex key index</code>：通过下标获取值</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; lindex list 1</span><br><span class="line"><span class="string">&quot;two&quot;</span></span><br><span class="line">localhost:6379&gt; lindex list 0</span><br><span class="line"><span class="string">&quot;three&quot;</span></span><br></pre></td></tr></table></figure>

<p><code>llen list</code> ：返回列表的长度</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; llen list</span><br><span class="line">(<span class="built_in">integer</span>) 5</span><br></pre></td></tr></table></figure>

<p><code>lrem key count value</code>：移除指定的值。比如取消关注。因为list中是允许有重复的value的，因此用count可以选择移除的个数。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; lrange list 0 -1</span><br><span class="line">1) <span class="string">&quot;three&quot;</span></span><br><span class="line">2) <span class="string">&quot;two&quot;</span></span><br><span class="line">3) <span class="string">&quot;one&quot;</span></span><br><span class="line">4) <span class="string">&quot;four&quot;</span></span><br><span class="line">5) <span class="string">&quot;five&quot;</span></span><br><span class="line">6) <span class="string">&quot;five&quot;</span></span><br><span class="line">localhost:6379&gt; lrem list 1 five	<span class="comment"># 移除一个第一个five</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">localhost:6379&gt; lrange list 0 -1</span><br><span class="line">1) <span class="string">&quot;three&quot;</span></span><br><span class="line">2) <span class="string">&quot;two&quot;</span></span><br><span class="line">3) <span class="string">&quot;one&quot;</span></span><br><span class="line">4) <span class="string">&quot;four&quot;</span></span><br><span class="line">5) <span class="string">&quot;five&quot;</span></span><br><span class="line">localhost:6379&gt; rpush list five</span><br><span class="line">(<span class="built_in">integer</span>) 6</span><br><span class="line">localhost:6379&gt; lrem list 2 five <span class="comment"># 移除前两个five</span></span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">localhost:6379&gt; lrange list 0 -1</span><br><span class="line">1) <span class="string">&quot;three&quot;</span></span><br><span class="line">2) <span class="string">&quot;two&quot;</span></span><br><span class="line">3) <span class="string">&quot;one&quot;</span></span><br><span class="line">4) <span class="string">&quot;four&quot;</span></span><br></pre></td></tr></table></figure>

<p> <code>ltrim key start end</code>：通过下标截取指定的长度，这个list已经被改变了，只剩下了list中下标从start 到 end的value。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; lrange mylist 0 -1</span><br><span class="line">1) <span class="string">&quot;three&quot;</span></span><br><span class="line">2) <span class="string">&quot;two&quot;</span></span><br><span class="line">3) <span class="string">&quot;one&quot;</span></span><br><span class="line">4) <span class="string">&quot;four&quot;</span></span><br><span class="line">localhost:6379&gt; ltrim mylist 1 2</span><br><span class="line">OK</span><br><span class="line">localhost:6379&gt; lrange mylist 0 -1</span><br><span class="line">1) <span class="string">&quot;two&quot;</span></span><br><span class="line">2) <span class="string">&quot;one&quot;</span></span><br></pre></td></tr></table></figure>

<p><code>rpoplpush key1 key2</code>：先rpop key1中的数据，然后lpush 进key2中</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; lrange mylist 0 -1</span><br><span class="line">1) <span class="string">&quot;two&quot;</span></span><br><span class="line">2) <span class="string">&quot;one&quot;</span></span><br><span class="line">localhost:6379&gt; lpush mylist three</span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">localhost:6379&gt; rpoplpush mylist myotherlist</span><br><span class="line"><span class="string">&quot;one&quot;</span></span><br><span class="line">localhost:6379&gt; lrange mylist 0 -1</span><br><span class="line">1) <span class="string">&quot;three&quot;</span></span><br><span class="line">2) <span class="string">&quot;two&quot;</span></span><br><span class="line">localhost:6379&gt; lrange myotherlist 0 -1</span><br><span class="line">1) <span class="string">&quot;one&quot;</span></span><br></pre></td></tr></table></figure>

<p><code>lset key index value</code>：根据key设置指定下标的value，如果key不存在或者下标不存在都会报错。即<strong>lset只能用于更新，不能用于新增。</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; exists list		<span class="comment"># 先判断列表是否存在</span></span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">localhost:6379&gt; lset list 0 item	<span class="comment"># 不存在key直接更新报错</span></span><br><span class="line">(error) ERR no such key</span><br><span class="line">localhost:6379&gt; lpush list value1</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">localhost:6379&gt; lrange list 0 0</span><br><span class="line">1) <span class="string">&quot;value1&quot;</span></span><br><span class="line">localhost:6379&gt; lset list 2 item	<span class="comment"># 不存在下标直接更新报错</span></span><br><span class="line">(error) ERR index out of range</span><br><span class="line">localhost:6379&gt; lset list 0 item</span><br><span class="line">OK</span><br><span class="line">localhost:6379&gt; lrange list 0 0</span><br><span class="line">1) <span class="string">&quot;item&quot;</span></span><br></pre></td></tr></table></figure>

<p><code>linsert key before/after pivot element</code>：在指定key列表中的某个具体的值 前面/后面 插入一个新值</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; rpush mylist <span class="string">&quot;hello&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">localhost:6379&gt; rpush mylist <span class="string">&quot;world&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">localhost:6379&gt; linsert mylist before <span class="string">&quot;world&quot;</span> <span class="string">&quot;my&quot;</span> <span class="comment"># 在world前面添加一个my</span></span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">localhost:6379&gt; lrange mylist 0 -1</span><br><span class="line">1) <span class="string">&quot;hello&quot;</span></span><br><span class="line">2) <span class="string">&quot;my&quot;</span></span><br><span class="line">3) <span class="string">&quot;world&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h4><p><code>sadd set &quot;member1&quot; &quot;member2&quot; ...</code>：在Set中添加成员，称之为成员member，也正是因为set中不能用重复元素。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; sadd myset <span class="string">&quot;hello&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">localhost:6379&gt; sadd myset <span class="string">&quot;my&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">localhost:6379&gt; sadd myset <span class="string">&quot;world&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line"><span class="comment"># 也可以 sadd myset &quot;hello&quot; &quot;my&quot; &quot;world&quot;</span></span><br></pre></td></tr></table></figure>

<p> <code>smembers set</code>：查看set中的所有成员</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; smembers myset</span><br><span class="line">1) <span class="string">&quot;my&quot;</span></span><br><span class="line">2) <span class="string">&quot;hello&quot;</span></span><br><span class="line">3) <span class="string">&quot;world&quot;</span></span><br></pre></td></tr></table></figure>

<p> <code>sismember set member </code>：判断是否是set中的一个成员</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; sismember myset <span class="string">&quot;hello&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">localhost:6379&gt; sismember myset <span class="string">&quot;my&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br></pre></td></tr></table></figure>

<p><code>scard set</code>：获取set中的成员个数</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; scard myset</span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br></pre></td></tr></table></figure>

<p><code>srem set &quot;member1&quot; &quot;member2&quot; ...</code>：移除set中的成员</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; SMEMBERS myset</span><br><span class="line">1) <span class="string">&quot;my&quot;</span></span><br><span class="line">2) <span class="string">&quot;hello&quot;</span></span><br><span class="line">3) <span class="string">&quot;world&quot;</span></span><br><span class="line">4) <span class="string">&quot;member&quot;</span></span><br><span class="line">5) <span class="string">&quot;2&quot;</span></span><br><span class="line">6) <span class="string">&quot;1&quot;</span></span><br><span class="line">localhost:6379&gt; srem myset <span class="string">&quot;member&quot;</span> <span class="string">&quot;1&quot;</span> <span class="string">&quot;2&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">localhost:6379&gt; SMEMBERS myset</span><br><span class="line">1) <span class="string">&quot;hello&quot;</span></span><br><span class="line">2) <span class="string">&quot;my&quot;</span></span><br><span class="line">3) <span class="string">&quot;world&quot;</span></span><br></pre></td></tr></table></figure>

<p> <code>srandmember set count </code>：从set中随机获取count个成员，比如一个抽奖程序，无序且不重复。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; SMEMBERS myset</span><br><span class="line">1) <span class="string">&quot;hello&quot;</span></span><br><span class="line">2) <span class="string">&quot;my&quot;</span></span><br><span class="line">3) <span class="string">&quot;world&quot;</span></span><br><span class="line">localhost:6379&gt; srandmember myset</span><br><span class="line"><span class="string">&quot;world&quot;</span></span><br><span class="line">localhost:6379&gt; srandmember myset</span><br><span class="line"><span class="string">&quot;my&quot;</span></span><br><span class="line">localhost:6379&gt; srandmember myset</span><br><span class="line"><span class="string">&quot;my&quot;</span></span><br></pre></td></tr></table></figure>

<p><code>spop set count</code>：从set中随机删除count个成员</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; SMEMBERS myset</span><br><span class="line">1) <span class="string">&quot;hello&quot;</span></span><br><span class="line">2) <span class="string">&quot;my&quot;</span></span><br><span class="line">3) <span class="string">&quot;world&quot;</span></span><br><span class="line">localhost:6379&gt; spop myset</span><br><span class="line"><span class="string">&quot;world&quot;</span></span><br><span class="line">localhost:6379&gt; SMEMBERS myset</span><br><span class="line">1) <span class="string">&quot;hello&quot;</span></span><br><span class="line">2) <span class="string">&quot;my&quot;</span></span><br></pre></td></tr></table></figure>

<p><code>smove source destination member</code>：从源set中将member移动到目的set中</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; sadd myset <span class="string">&quot;hello&quot;</span> <span class="string">&quot;my&quot;</span> <span class="string">&quot;world&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">localhost:6379&gt; sadd myset2 <span class="string">&quot;hello2&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">localhost:6379&gt; smove myset myset2 <span class="string">&quot;hello&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">localhost:6379&gt; smembers myset</span><br><span class="line">1) <span class="string">&quot;my&quot;</span></span><br><span class="line">2) <span class="string">&quot;world&quot;</span></span><br><span class="line">localhost:6379&gt; smembers myset2</span><br><span class="line">1) <span class="string">&quot;hello&quot;</span></span><br><span class="line">2) <span class="string">&quot;hello2&quot;</span></span><br></pre></td></tr></table></figure>

<p><strong>交集、并集、差集</strong></p>
<p><code>sdiff set1 set2</code>：<strong>返回set1和set2差集，即set1-set2。</strong>即是返回存在于set1但是不存在于set2中的成员。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; sadd set1 a b c</span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">localhost:6379&gt; sadd set2 c d e</span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">localhost:6379&gt; sdiff set1 set2 <span class="comment"># 差集</span></span><br><span class="line">1) <span class="string">&quot;b&quot;</span></span><br><span class="line">2) <span class="string">&quot;a&quot;</span></span><br><span class="line">localhost:6379&gt; sdiff set2 set1</span><br><span class="line">1) <span class="string">&quot;d&quot;</span></span><br><span class="line">2) <span class="string">&quot;e&quot;</span></span><br></pre></td></tr></table></figure>

<p> <code>sinter set1 set2</code>：<strong>返回set1和set2的交集，即set1 ∩ set2</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; sinter set1 set2 <span class="comment"># 交集 共同好友或者共同关注</span></span><br><span class="line">1) <span class="string">&quot;c&quot;</span></span><br></pre></td></tr></table></figure>

<p> <code>sunion set1 set2</code>：<strong>返回set1和set2的并集，即set1∪set2</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; sunion set1 set2</span><br><span class="line">1) <span class="string">&quot;e&quot;</span></span><br><span class="line">2) <span class="string">&quot;a&quot;</span></span><br><span class="line">3) <span class="string">&quot;c&quot;</span></span><br><span class="line">4) <span class="string">&quot;b&quot;</span></span><br><span class="line">5) <span class="string">&quot;d&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="Hash"><a href="#Hash" class="headerlink" title="Hash"></a>Hash</h4><p>hash的存储结构类似于key - map&lt;key , value&gt;</p>
<p>可以用hash存储经常变动的信息，比如用户信息的保存，更适合与对象的存储，String更加适合字符串的存储</p>
<p> <code>hset hash field value</code>：给某个hash中的一个entry赋值</p>
<p><code>hmset hash field1 value1 filed2 value2 ...</code>：同时设置多个key，value</p>
<p><code>hmget hash field1 field2</code>：获取多个字段值</p>
<p><code>hgetall hash</code>：获取hash中的所有entry</p>
<p><code>hdel hash field</code>：删除hash中指定的field</p>
<p><code>hlen hash</code>：获取当前hash的长度，相当于entry的个数。</p>
<p><code>hexists hash field</code>：判断hash中的指定field是否存在</p>
<p> <code>hkeys hash</code>：只获得所有的field</p>
<p><code>hvals hash</code>：只获得所有的value</p>
<p><code>hincrby hash field increment</code>：将hash中指定field增加指定的数</p>
<p> <code>hdecrby hash field increment</code>：将hash中指定field减小指定的数</p>
<p> <code>hsetnx hash field value</code>：如果不存在则可以设置，存在则不能设置</p>
<h4 id="Zset"><a href="#Zset" class="headerlink" title="Zset"></a>Zset</h4><p>在set的基础上，增加了一个score值，可以存储某个排行榜，热门榜，Top 10</p>
<p><code>zadd key score value  </code>：添加一个值</p>
<p><code>zrange key min max </code>：获取指定范围的值</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; zadd myzset 2 <span class="string">&quot;hello&quot;</span> 5 <span class="string">&quot;my&quot;</span> 1 <span class="string">&quot;world&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">localhost:6379&gt; zrange myzset 0 -1</span><br><span class="line">1) <span class="string">&quot;world&quot;</span></span><br><span class="line">2) <span class="string">&quot;hello&quot;</span></span><br><span class="line">3) <span class="string">&quot;my&quot;</span></span><br></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zadd myset 1 one	<span class="comment"># 添加一个值</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; zadd myset 2 two 3 three<span class="comment"># 添加多个值</span></span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">127.0.0.1:6379&gt; ZRANGE myset 0 -1</span><br><span class="line">1) <span class="string">&quot;one&quot;</span></span><br><span class="line">2) <span class="string">&quot;two&quot;</span></span><br><span class="line">3) <span class="string">&quot;three&quot;</span></span><br></pre></td></tr></table></figure>

<p>可以用做一个排行榜，比如发薪水的时候。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; zadd salary 5000 <span class="string">&quot;zs&quot;</span> 6000 <span class="string">&quot;ls&quot;</span> 1800 <span class="string">&quot;zc&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">localhost:6379&gt; zrange salary 0 -1</span><br><span class="line">1) <span class="string">&quot;zc&quot;</span></span><br><span class="line">2) <span class="string">&quot;zs&quot;</span></span><br><span class="line">3) <span class="string">&quot;ls&quot;</span></span><br></pre></td></tr></table></figure>

<p><code>zrangebyscore key -inf +inf withscores</code>：<strong>升序</strong>输出指定范围的value并且带上score，-inf/+inf 方便代表负/正无穷</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; zrangebyscore salary -inf +inf</span><br><span class="line">1) <span class="string">&quot;zc&quot;</span></span><br><span class="line">2) <span class="string">&quot;zs&quot;</span></span><br><span class="line">3) <span class="string">&quot;ls&quot;</span></span><br><span class="line">localhost:6379&gt; zrangebyscore salary -inf +inf withscores</span><br><span class="line">1) <span class="string">&quot;zc&quot;</span></span><br><span class="line">2) <span class="string">&quot;1800&quot;</span></span><br><span class="line">3) <span class="string">&quot;zs&quot;</span></span><br><span class="line">4) <span class="string">&quot;5000&quot;</span></span><br><span class="line">5) <span class="string">&quot;ls&quot;</span></span><br><span class="line">6) <span class="string">&quot;6000&quot;</span></span><br></pre></td></tr></table></figure>

<p><code> ZREVRANGEbyscore salary +inf -inf withscores</code>：<strong>降序</strong>输出指定范围的value并且带上score，这里就需要使用+inf -inf</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; ZREVRANGEbyscore salary +inf -inf</span><br><span class="line">1) <span class="string">&quot;ls&quot;</span></span><br><span class="line">2) <span class="string">&quot;zs&quot;</span></span><br><span class="line">3) <span class="string">&quot;zc&quot;</span></span><br><span class="line">localhost:6379&gt; ZREVRANGEbyscore salary +inf -inf withscores</span><br><span class="line">1) <span class="string">&quot;ls&quot;</span></span><br><span class="line">2) <span class="string">&quot;6000&quot;</span></span><br><span class="line">3) <span class="string">&quot;zs&quot;</span></span><br><span class="line">4) <span class="string">&quot;5000&quot;</span></span><br><span class="line">5) <span class="string">&quot;zc&quot;</span></span><br><span class="line">6) <span class="string">&quot;1800&quot;</span></span><br></pre></td></tr></table></figure>

<p><code>zrem key value</code>：移除有序集合中的指定元素</p>
<p><code>zcard salary</code>：获取有序集合的大小</p>
<p><code>zcount key start end</code>：获取指定score区间的成员数量</p>
<p><code>ZSCORE key member</code></p>
<ul>
<li>返回有序集key中，成员member的score值。</li>
<li>如果member元素不是有序集key的成员，或key不存在，返回nil。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zadd myzset 1 <span class="string">&quot;one&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; zscore myzset <span class="string">&quot;one&quot;</span></span><br><span class="line"><span class="string">&quot;1&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; zscore myzset <span class="string">&quot;two&quot;</span></span><br><span class="line">nil</span><br></pre></td></tr></table></figure>

<h4 id="三种特殊数据类型"><a href="#三种特殊数据类型" class="headerlink" title="三种特殊数据类型"></a>三种特殊数据类型</h4><h5 id="geospatial"><a href="#geospatial" class="headerlink" title="geospatial"></a>geospatial</h5><p>Redis的Geo在Redis 3.2 就推出了，这个功能可以推算出地址位置的信息，两地之间的距离，方圆几里的人。</p>
<p>有效的经度从-180度到180度。<br>有效的纬度从-85.05112878度到85.05112878度。<br>当坐标位置超出上述指定范围时，该命令将会返回一个错误。</p>
<p>城市经纬度查询：<a target="_blank" rel="noopener" href="http://www.jsons.cn/lngcode/">http://www.jsons.cn/lngcode/</a></p>
<p>朋友的定位，附近的人，打车距离计算… </p>
<p>查找我附近的人：获取要查找位置的经纬度，然后给出附近的半径。然后通过命令georadius查询。</p>
<p> <code>geoadd key longitude latitude member</code>：指定key添加member的经度，纬度</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; geoadd china:city 116.405285 39.904989 beijing</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br></pre></td></tr></table></figure>

<p> <code>geopos key member1 member2</code>：获取指定 member 的经纬度</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; GEOPOS china:city beijing</span><br><span class="line">1) 1) <span class="string">&quot;116.40528291463851929&quot;</span></span><br><span class="line">   2) <span class="string">&quot;39.9049884229125027&quot;</span></span><br></pre></td></tr></table></figure>

<p><code>geodist key member1 member2 [m/km/mi/ft] </code>：获取member1和member2的距离 </p>
<p>单位∶</p>
<ul>
<li>m表示单位为米。</li>
<li>km表示单位为千米。</li>
<li>mi表示单位为英里。</li>
<li>ft表示单位为英尺。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; geoadd china:city 106.504962 29.533155 chongqing</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">localhost:6379&gt; geopos china:city chongqing</span><br><span class="line">1) 1) <span class="string">&quot;106.50495976209640503&quot;</span></span><br><span class="line">   2) <span class="string">&quot;29.53315530684997015&quot;</span></span><br><span class="line">localhost:6379&gt; geodist china:city beijing chongqing m		<span class="comment"># 单位m</span></span><br><span class="line"><span class="string">&quot;1464221.0451&quot;</span></span><br><span class="line">localhost:6379&gt; geodist china:city beijing chongqing km		<span class="comment"># 单位km</span></span><br><span class="line"><span class="string">&quot;1464.2210&quot;</span></span><br></pre></td></tr></table></figure>

<p> <code>georadius key longitude latitude radius [m/km/mi/ft] withdist withcoord count number asc desc    </code>：获取指定经纬度且以radius为半径的key中所有member，中心点是以某个坐标来定义的。</p>
<p>withdist输出的时候带上距离一起输出；withcoord 输出的时候带坐标（经纬度）输出；count number 指定输出多少个城市；asc，desc升序降序排列。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; GEORADIUS china:city 110 30 1000 km </span><br><span class="line">1) <span class="string">&quot;chongqing&quot;</span></span><br><span class="line">2) <span class="string">&quot;xian&quot;</span></span><br><span class="line">3)<span class="string">&quot;shengzhen&quot;</span></span><br><span class="line">4)<span class="string">&quot;hangzhou&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; GEORADIUS china: city 110 30 500 km</span><br><span class="line">1) <span class="string">&quot;chongqing&quot;</span></span><br><span class="line">2)<span class="string">&quot;xian&quot;</span></span><br></pre></td></tr></table></figure>

<p><code>GEORADIUSBYMEMBER key member radius [m/km/mi/ft]</code>： 找出位于指定元素周围的其他元素</p>
<p><code>geohash china:city member1 mbmber2...</code>：将二维的经纬度转换为一维的字符串，字符串相同个数越多，则两个位置越接近。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; geohash china:city beijing chongqing</span><br><span class="line">1) <span class="string">&quot;wx4fbxxfkeO&quot;</span></span><br><span class="line">2) <span class="string">&quot;wm5xzrybtyo&quot;</span></span><br></pre></td></tr></table></figure>

<h5 id="Hyperloglog"><a href="#Hyperloglog" class="headerlink" title="Hyperloglog"></a>Hyperloglog</h5><p>基数统计：就是找到一个集合中不重复的元素的个数</p>
<p>A {1,3,5,7,8,7}    B {1,3,5,7,8}    A和B的基数就是5；</p>
<p>应用场景：</p>
<p>Redis Hyperloglog采用<strong>基数统计的算法</strong>，是有<strong>错误率</strong>的，适用于能接收容错的数据，就比如网页的UV。</p>
<p>set 的结构去保存用户，然后统计人数，占用的内存空间大</p>
<p><strong>Hyperloglog占用的内存固定，2^64不同的元素的基数，只需要12KB的内存</strong></p>
<p><code>pfadd key element1 element2...</code>：指定key中添加元素，可以重复。</p>
<p><code>pfconut key1 key2...</code>：对key或者几个key一起求基数</p>
<p> <code>pfmerger key3 key1 key2 </code>：合并key1，key2到key3中。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">localhost:6379&gt; pfadd mykey a b c d e f g h i j		<span class="comment"># 添加一个key</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">localhost:6379&gt; PFCOUNT mykey	<span class="comment"># 统计mykey中的不重复元素个数</span></span><br><span class="line">(<span class="built_in">integer</span>) 10</span><br><span class="line">localhost:6379&gt; pfadd mykey2 i j z x c v b n m</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">localhost:6379&gt; pfcount mykey2</span><br><span class="line">(<span class="built_in">integer</span>) 9</span><br><span class="line">localhost:6379&gt; pfmerge mykey3 mykey mykey2	<span class="comment"># 将mykey和mykey2基数合并到mykey3，并集</span></span><br><span class="line">OK</span><br><span class="line">localhost:6379&gt; pfcount mykey3</span><br><span class="line">(<span class="built_in">integer</span>) 15</span><br><span class="line">localhost:6379&gt; pfcount mykey mykey2	<span class="comment"># 统计mykey和mykey2两者的不重复元素个数</span></span><br><span class="line">(<span class="built_in">integer</span>) 15</span><br></pre></td></tr></table></figure>

<h5 id="Bitmap"><a href="#Bitmap" class="headerlink" title="Bitmap"></a>Bitmap</h5><p>Bitmap位图，操作二进制位来进行记录，就只有0和1两个状态</p>
<p>应用场景</p>
<p>统计用户信息，活跃用户、不活跃用户，登录、未登录的状态。签到打卡都可以用bitmap来实现。</p>
<p>使用bitmap来记录周一到周日的打卡</p>
<p>周一到周日是否打卡签到</p>
<p><code>setbit key offset value</code>：设置当前key对应offset的value</p>
<p><code>getbit key offset</code>：获取当前key指定offset的value值</p>
<p><code>bitcount key start end</code>：获取key中offset从start到end中value为1的个数，不写start到end默认全部</p>
<h3 id="Redis-集群"><a href="#Redis-集群" class="headerlink" title="Redis 集群"></a>Redis 集群</h3><p>基于多个不同的端口搭建集群，如果要真实搭建集群可以采用多台虚拟机</p>
<ul>
<li>创建每个集群节点的文件列表</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mkdir /redis-cluster/redis&#123;7000..7005&#125; -pv</span><br></pre></td></tr></table></figure>

<ul>
<li>编写配置文件</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> /redis-cluster/redis7000/redis.conf</span></span><br><span class="line">daemonize yes</span><br><span class="line">port 7000</span><br><span class="line">cluster-enabled yes</span><br><span class="line">cluster-config-file /redis-cluster/redis7000/nodes-7000.conf</span><br><span class="line">cluster-node-timeout 5000</span><br><span class="line">appendonly yes</span><br><span class="line"><span class="meta">#</span><span class="bash"> /redis-cluster/redis7001/redis.conf</span></span><br><span class="line">daemonize yes</span><br><span class="line">port 7001</span><br><span class="line">cluster-enabled yes</span><br><span class="line">cluster-config-file /redis-cluster/redis7001/nodes-7001.conf</span><br><span class="line">cluster-node-timeout 5000</span><br><span class="line">appendonly yes</span><br><span class="line"><span class="meta">#</span><span class="bash"> /redis-cluster/redis7002/redis.conf</span></span><br><span class="line">daemonize yes</span><br><span class="line">port 7002</span><br><span class="line">cluster-enabled yes</span><br><span class="line">cluster-config-file /redis-cluster/redis7002/nodes-7002.conf</span><br><span class="line">cluster-node-timeout 5000</span><br><span class="line">appendonly yes</span><br><span class="line"><span class="meta">#</span><span class="bash"> /redis-cluster/redis7003/redis.conf</span></span><br><span class="line">daemonize yes</span><br><span class="line">port 7003</span><br><span class="line">cluster-enabled yes</span><br><span class="line">cluster-config-file /redis-cluster/redis7003/nodes-7003.conf</span><br><span class="line">cluster-node-timeout 5000</span><br><span class="line">appendonly yes</span><br><span class="line"><span class="meta">#</span><span class="bash"> /redis-cluster/redis7004/redis.conf</span></span><br><span class="line">daemonize yes</span><br><span class="line">port 7004</span><br><span class="line">cluster-enabled yes</span><br><span class="line">cluster-config-file /redis-cluster/redis7004/nodes-7004.conf</span><br><span class="line">cluster-node-timeout 5000</span><br><span class="line">appendonly yes</span><br><span class="line"><span class="meta">#</span><span class="bash"> /redis-cluster/redis7005/redis.conf</span></span><br><span class="line">daemonize yes</span><br><span class="line">port 7005</span><br><span class="line">cluster-enabled yes</span><br><span class="line">cluster-config-file /redis-cluster/redis7005/nodes-7005.conf</span><br><span class="line">cluster-node-timeout 5000</span><br><span class="line">appendonly yes</span><br></pre></td></tr></table></figure>

<ul>
<li>开启各节点的 Redis</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">redis-server /redis-cluster/redis7000/redis.conf</span><br><span class="line">redis-server /redis-cluster/redis7001/redis.conf</span><br><span class="line">redis-server /redis-cluster/redis7002/redis.conf</span><br><span class="line">redis-server /redis-cluster/redis7003/redis.conf</span><br><span class="line">redis-server /redis-cluster/redis7004/redis.conf</span><br><span class="line">redis-server /redis-cluster/redis7005/redis.conf</span><br></pre></td></tr></table></figure>

<ul>
<li>查看进程是否正常</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ps -aux | grep redis</span><br></pre></td></tr></table></figure>

<ul>
<li>部署集群，分配主从</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">redis-cli --cluster create 127.0.0.1:7000 127.0.0.1:7001 127.0.0.1:7002 127.0.0.1:7003 127.0.0.1:7004 127.0.0.1:7005 --cluster-replicas 1		# 1表示主从比例，即6个节点3主3从</span><br></pre></td></tr></table></figure>



<h2 id="Kafka"><a href="#Kafka" class="headerlink" title="Kafka"></a>Kafka</h2><h3 id="Kafka-基本操作"><a href="#Kafka-基本操作" class="headerlink" title="Kafka 基本操作"></a>Kafka 基本操作</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 启动Kafka</span></span><br><span class="line">./kafka-server-start.sh -daemon ../config/server.properties</span><br></pre></td></tr></table></figure>

<p>创建主题</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">./kafka-topics.sh --create --bootstrap-server 192.168.73.137:9092 --topic first_test_topic --partition 1 --replication-factor 1</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查询所有主题</span></span><br><span class="line">./kafka-topics.sh --bootstrap-server 192.168.73.137:9092 --list</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查询Kafka的指定主题</span></span><br><span class="line">./kafka-topics.sh --bootstrap-server 192.168.73.137:9092 --describe first_test_topic</span><br></pre></td></tr></table></figure>

<p>发送消息</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@192 bin]# ./kafka-console-producer.sh --bootstrap-server 192.168.73.137:9092 --topic first_test_topic</span><br><span class="line">OpenJDK 64-Bit Server VM warning: If the number of processors is expected to increase from one, then you should configure the number of parallel GC threads appropriately using -XX:ParallelGCThreads=N</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">hello</span></span><br></pre></td></tr></table></figure>

<p>消费消息</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 默认是消费最新的消息，是从历史消息中最后一条消息的偏移量+1开始消费的，也就是这个Consumer启动后，接收到的第一条消息</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 因此，这时候上面的 hello 是消费不到的</span></span><br><span class="line">[root@192 bin]# ./kafka-console-consumer.sh --bootstrap-server 192.168.73.137:9092 --topic first_test_topic</span><br></pre></td></tr></table></figure>

<p>还有一种模式，可以直接 **从头开始 –from-beginning **消费，这样，历史的消息记录，也可以消费得到</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@192 bin]<span class="comment"># ./kafka-console-consumer.sh --bootstrap-server 192.168.73.137:9092 --topic first_test_topic --from-beginning</span></span><br><span class="line">OpenJDK 64-Bit Server VM warning: If the number of processors is expected to increase from one, <span class="keyword">then</span> you should configure the number of parallel GC threads appropriately using -XX:ParallelGCThreads=N</span><br><span class="line">hello</span><br><span class="line">kafka</span><br></pre></td></tr></table></figure>

<p>指定消费者消费者组</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">./kafka-console-consumer.sh --bootstrap-server 192.168.73.137:9092 --consumer-property group.id=testGroup --topic first_test_topic</span><br></pre></td></tr></table></figure>

<p>查看消费者组</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看当前主题下有哪些消费组</span></span><br><span class="line">./kafka-consumer-groups.sh --bootstrap-server 192.168.73.137:9092 --list</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看消费组中的具体信息：比如当前偏移量、最后一条消息的偏移量、堆积的消息数量</span></span><br><span class="line">./kafka-consumer-groups.sh --bootstrap-server 192.168.73.137:9092 --describe --group testGroup</span><br><span class="line"></span><br><span class="line">[root@zc bin]# ./kafka-consumer-groups.sh --bootstrap-server 192.168.73.137:9092 --describe --group testGroup</span><br><span class="line"></span><br><span class="line">GROUP TOPIC PARTITION  CURRENT-OFFSET  LOG-END-OFFSET  LAG CONSUMER-ID HOST CLIENT-ID</span><br><span class="line">testGroup       test_topic      0          0               0               0               console-consumer-41881961-22dc-4462-8252-cd2addb88a92 /192.168.73.137  console-consumer</span><br></pre></td></tr></table></figure>

<p>修改分区数</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@192 bin]# ./kafka-topics.sh --bootstrap-server 192.168.73.137:9092 --alter --topic first_test_topic --partitions 3</span><br><span class="line">OpenJDK 64-Bit Server VM warning: If the number of processors is expected to increase from one, then you should configure the number of parallel GC threads appropriately using -XX:ParallelGCThreads=N</span><br><span class="line">[root@192 bin]# ./kafka-topics.sh --bootstrap-server 192.168.73.137:9092 --describe --topic first_test_topic</span><br><span class="line">OpenJDK 64-Bit Server VM warning: If the number of processors is expected to increase from one, then you should configure the number of parallel GC threads appropriately using -XX:ParallelGCThreads=N</span><br><span class="line">Topic: first_test_topic	TopicId: vi8l4UdNR8ydP9o0bhCYYA	PartitionCount: 3	ReplicationFactor: 1	Configs: segment.bytes=1073741824</span><br><span class="line">	Topic: first_test_topic	Partition: 0	Leader: 0	Replicas: 0	Isr: 0</span><br><span class="line">	Topic: first_test_topic	Partition: 1	Leader: 1	Replicas: 1	Isr: 1</span><br><span class="line">	Topic: first_test_topic	Partition: 2	Leader: 2	Replicas: 2	Isr: 2</span><br></pre></td></tr></table></figure>

<h3 id="Kafka-集群"><a href="#Kafka-集群" class="headerlink" title="Kafka 集群"></a>Kafka 集群</h3><p>首先搭建好 Zookeeper 集群，可以参照上面 Zookeeper 集群搭建过程。这里采用三台虚拟机搭建</p>
<ol>
<li>进行配置文件目录，修改配置文件<code>server.properties</code>，主要修改以下内容</li>
</ol>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 每个broker的id是唯一的，每个 kafka 节点id 都需要不同</span></span><br><span class="line">broker.id=0	</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 指定监听的地址和端口号，IP是内网IP</span></span><br><span class="line">listeners=PLAINTEXT://192.168.73.137:9092</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 指定监听的地址和端口号，IP是外网IP</span></span><br><span class="line"><span class="meta">#</span><span class="bash">advertised.listeners=PLAINTEXT://your.host.name:9092</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 指定数据日志目录</span></span><br><span class="line">log.dirs=/usr/local/kafka/logs</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 指定zk的连接地址</span></span><br><span class="line">zookeeper.connect=192.168.73.137:2181,192.168.73.136:2181,192.168.73.135:2181</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>启动 kafka 集群</li>
</ol>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@192 kafka]# ./bin/kafka-server-start.sh -daemon config/server.properties </span><br><span class="line">[root@192 kafka]# netstat -lntp | grep 9092</span><br><span class="line">tcp6       0      0 192.168.73.137:9092     :::*                    LISTEN      19603/java</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>到Zookeeper集群下查看所有的broker</li>
</ol>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 1] ls /brokers/ids</span><br><span class="line">[0, 1, 2]</span><br><span class="line">[zk: localhost:2181(CONNECTED) 2] </span><br></pre></td></tr></table></figure>

<h2 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h2><h3 id="cat"><a href="#cat" class="headerlink" title="cat"></a>cat</h3><ol>
<li>cat 命令用于查看文本文档的命令，如果是二进制文件 cat 命令自然会乱码。</li>
<li>cat 命令主要用来查看配置文件，如果比较大的日志文件用 cat 可能会卡住，会花费比较长的时间，所以看日志一般使用 tail，more</li>
</ol>
<p><strong>主要使用：</strong></p>
<p>常用参数：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">-n 或 --number 由 1 开始对所有输出的行数编号</span><br><span class="line">-b 或 --number-nonblank 和 -n 相似，只不过对于空白行不编号</span><br><span class="line">-s 或 --squeeze-blank 当遇到有连续两行以上的空白行，就代换为一行的空白行</span><br><span class="line">-E --show-ends 在每行结束处显示 $</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> cat &gt; filename 从键盘创建一个文件</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 输入想要的文件内容 ctrl + backspace 删除输入的内容</span></span><br><span class="line">[root@iZbp1a8a1ba5rtv9pgdsuzZ ~]# cat &gt; filename</span><br><span class="line">ins1mnia</span><br><span class="line">ins1mnia&#x27;s cat</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> cat filename 查看一个文件的内容</span></span><br><span class="line">[root@iZbp1a8a1ba5rtv9pgdsuzZ ~]# cat filename</span><br><span class="line">ins1mnia</span><br><span class="line">ins1mnia&#x27;s cat</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> &gt; 重定向 用 filename 文件的内容 覆盖 newfile 文件</span></span><br><span class="line">[root@iZbp1a8a1ba5rtv9pgdsuzZ ~]# cat filename &gt; newfile</span><br><span class="line">[root@iZbp1a8a1ba5rtv9pgdsuzZ ~]# cat newfile</span><br><span class="line">ins1mnia</span><br><span class="line">ins1mnia&#x27;s cat</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> &gt;&gt; 附加符号 将 filename 文件附加到 file2 文件末尾</span></span><br><span class="line">[root@iZbp1a8a1ba5rtv9pgdsuzZ ~]# cat filename &gt;&gt; newfile</span><br><span class="line">[root@iZbp1a8a1ba5rtv9pgdsuzZ ~]# cat newfile</span><br><span class="line">ins1mnia</span><br><span class="line">ins1mnia&#x27;s cat</span><br><span class="line">ins1mnia</span><br><span class="line">ins1mnia&#x27;s cat</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 结合管道符 查看 newfile 的前 1 行的内容</span></span><br><span class="line">[root@iZbp1a8a1ba5rtv9pgdsuzZ ~]# cat newfile | head -n 1</span><br><span class="line">ins1mnia</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 结合管道符 查看 newfile 的后 3 行的内容</span></span><br><span class="line">[root@iZbp1a8a1ba5rtv9pgdsuzZ ~]# cat newfile | tail -n 3</span><br><span class="line">ins1mnia&#x27;s cat</span><br><span class="line">ins1mnia</span><br><span class="line">ins1mnia&#x27;s cat</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> cat file1 file2 &gt; file3 把 file1 file2的内容合并到file3</span></span><br><span class="line">[root@iZbp1a8a1ba5rtv9pgdsuzZ ~]# cat file</span><br><span class="line">ins1mnia</span><br><span class="line">ins1mnia&#x27;s cat</span><br><span class="line">[root@iZbp1a8a1ba5rtv9pgdsuzZ ~]# cat file filename &gt; file1</span><br><span class="line">[root@iZbp1a8a1ba5rtv9pgdsuzZ ~]# cat file1</span><br><span class="line">ins1mnia</span><br><span class="line">ins1mnia&#x27;s cat</span><br><span class="line">ins1mnia</span><br><span class="line">ins1mnia&#x27;s cat</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> cat -n file 对每一行编号</span></span><br><span class="line">[root@iZbp1a8a1ba5rtv9pgdsuzZ ~]# cat -n file1</span><br><span class="line">     1  ins1mnia</span><br><span class="line">     2  ins1mnia&#x27;s cat</span><br><span class="line">     3  ins1mnia</span><br><span class="line">     4  ins1mnia&#x27;s cat</span><br></pre></td></tr></table></figure>

<h3 id="more"><a href="#more" class="headerlink" title="more"></a>more</h3><p>more 类似与 cat，cat 是整个文件的内容从上到下显示在屏幕上，<strong>more</strong> 则<strong>一页一页的显示</strong>，按 <strong>‘空格’</strong> 即可显示<strong>下一页</strong>，并且<strong>底部</strong>会<strong>显示</strong>当前展示内容所在整个文件<strong>比例</strong>。按 <strong>‘回车’</strong> 即可显示<strong>下一行</strong> （向下n行，默认一行），按 <strong>‘b’</strong> (back) 即可<strong>往回显示一页</strong>，<strong>‘q’ 退出</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@iZbp1a8a1ba5rtv9pgdsuzZ logs]# more server.log</span><br><span class="line">[2022-07-25 13:49:51,074] INFO Terminating process due to signal SIGTERM (org.apache.kafka.common.utils.LoggingSignalHandler)</span><br><span class="line">[2022-07-25 13:49:51,094] INFO [KafkaServer id=0] shutting down (kafka.server.KafkaServer)</span><br><span class="line">[2022-07-25 13:49:51,097] INFO [KafkaServer id=0] Starting controlled shutdown (kafka.server.KafkaServer)</span><br><span class="line">[2022-07-25 13:49:51,128] INFO [KafkaServer id=0] Controlled shutdown request returned successfully after 20ms (kafka.server.KafkaServer)</span><br><span class="line">[2022-07-25 13:49:51,135] INFO [/config/changes-event-process-thread]: Shutting down (kafka.common.ZkNodeChangeNotificationListener$ChangeEventProcessThr</span><br><span class="line">ead)</span><br><span class="line">[2022-07-25 13:49:51,136] INFO [/config/changes-event-process-thread]: Stopped (kafka.common.ZkNodeChangeNotificationListener$ChangeEventProcessThread)</span><br><span class="line">[2022-07-25 13:49:51,139] INFO [/config/changes-event-process-thread]: Shutdown completed (kafka.common.ZkNodeChangeNotificationListener$ChangeEventProce</span><br><span class="line">ssThread)</span><br><span class="line">[2022-07-25 13:49:51,141] INFO [SocketServer listenerType=ZK_BROKER, nodeId=0] Stopping socket server request processors (kafka.network.SocketServer)</span><br><span class="line">[2022-07-25 13:49:51,162] INFO [SocketServer listenerType=ZK_BROKER, nodeId=0] Stopped socket server request processors (kafka.network.SocketServer)</span><br><span class="line">[2022-07-25 13:49:51,166] INFO [data-plane Kafka Request Handler on Broker 0], shutting down (kafka.server.KafkaRequestHandlerPool)</span><br><span class="line">[2022-07-25 13:49:51,171] INFO [data-plane Kafka Request Handler on Broker 0], shut down completely (kafka.server.KafkaRequestHandlerPool)</span><br><span class="line">[2022-07-25 13:49:51,177] INFO [ExpirationReaper-0-AlterAcls]: Shutting down (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)</span><br><span class="line">[2022-07-25 13:49:51,180] INFO [ExpirationReaper-0-AlterAcls]: Stopped (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)</span><br><span class="line">--更多--(13%)</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> more +n filename 从第 n 行开始显示</span> </span><br><span class="line">more +10 server.log</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> more -n filename 一次显示 n 行</span></span><br><span class="line">more -10 server.log</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> more -p filename 清除荧幕，开始展示 filename 内容</span></span><br><span class="line">[root@iZbp1a8a1ba5rtv9pgdsuzZ logs]# more -10 server.log -p</span><br><span class="line">::::::::::::::</span><br><span class="line">server.log</span><br><span class="line">::::::::::::::</span><br><span class="line">[2022-07-25 13:49:51,074] INFO Terminating process due to signal SIGTERM (org.apache.kafka.common.utils.LoggingSignalHandler)</span><br><span class="line">[2022-07-25 13:49:51,094] INFO [KafkaServer id=0] shutting down (kafka.server.KafkaServer)</span><br><span class="line">[2022-07-25 13:49:51,097] INFO [KafkaServer id=0] Starting controlled shutdown (kafka.server.KafkaServer)</span><br><span class="line">[2022-07-25 13:49:51,128] INFO [KafkaServer id=0] Controlled shutdown request returned successfully after 20ms (kafka.server.KafkaServer)</span><br><span class="line">[2022-07-25 13:49:51,135] INFO [/config/changes-event-process-thread]: Shutting down (kafka.common.ZkNodeChangeNotificationListener$ChangeEventProcessThr</span><br><span class="line">ead)</span><br><span class="line">[2022-07-25 13:49:51,136] INFO [/config/changes-event-process-thread]: Stopped (kafka.common.ZkNodeChangeNotificationListener$ChangeEventProcessThread)</span><br><span class="line">[2022-07-25 13:49:51,139] INFO [/config/changes-event-process-thread]: Shutdown completed (kafka.common.ZkNodeChangeNotificationListener$ChangeEventProce</span><br><span class="line">ssThread)</span><br><span class="line">[2022-07-25 13:49:51,141] INFO [SocketServer listenerType=ZK_BROKER, nodeId=0] Stopping socket server request processors (kafka.network.SocketServer)</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> ps -ef 结合 more 查看当前进程</span></span><br><span class="line">ps -ef |more</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><strong>更多参数：</strong></p>
<ol>
<li><strong>-d</strong> 提示使用者，在画面下方显示 [Press space to continue, ‘q’ to quit.] ，如果使用者按错键，则会显示 [Press ‘h’ for instructions.] 而不是 ‘哔’ 声</li>
<li><strong>-p</strong> 不以卷动的方式显示每一页，而是<strong>先清除萤幕</strong>后再显示内容</li>
<li><strong>+/pattern</strong> 在每个文档显示前搜寻该字串（pattern），然后从该字串之后开始显示</li>
</ol>
<p><strong>操作命令：</strong></p>
<ol>
<li><strong>:f</strong> 输出文件名和当前行的行号</li>
<li><strong>Ctrl+F</strong> 向下滚动一屏</li>
<li><strong>空格键</strong> 向下滚动一屏</li>
<li><strong>Ctrl+B</strong> 返回上一屏</li>
<li><strong>=</strong> 输出当前行的行号</li>
<li><strong>q</strong> 退出more</li>
<li><strong>V</strong> 调用vi编辑器</li>
</ol>
<h3 id="less"><a href="#less" class="headerlink" title="less"></a>less</h3><p>less 与 more 类似，less 可以随意浏览文件，支持翻页和搜索，支持向上翻页和向下翻页。</p>
<p>less 的一些通用操作命令同more一样，more 中能用的操作命令都可以在less 中试一试，比如 回车，空格下翻页，:f 输出文件名等内容……</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看文件</span></span><br><span class="line">less server.log</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> less 中 /字符串 向下搜索<span class="string">&quot;字符串&quot;</span>的功能 n 向下一个搜索 b N 向上一个搜索</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 浏览多个文件 :n 切换到server.log :p 切换到 controller.log</span></span><br><span class="line">less controller.log server.log</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 结合 less 查看进程</span></span><br><span class="line">ps -ef |less</span><br></pre></td></tr></table></figure>

<h3 id="tail"><a href="#tail" class="headerlink" title="tail"></a>tail</h3><p>tail 命令也用于查看文件的内容，有一个常用的参数 <strong>-f</strong> 常用于<strong>查阅正在改变的日志文件</strong>。当日志文件正在输出，改变的时候，**<code>tail -f filename</code>** 会把 filename 文件里的最尾部的内容显示在屏幕上，并且不断刷新，只要 filename 更新就可以看到最新的文件内容。</p>
<p><strong>常用参数：</strong></p>
<ol>
<li><strong>-f</strong> 循环读取</li>
<li>-c &lt;数目&gt; 显示的字符数</li>
<li>-n &lt;行数&gt; 显示文件的尾部 n 行内容</li>
</ol>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> tail 显示 server.log 的最后10行 默认是最后10行</span></span><br><span class="line">tail server.log</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 显示 尾部 9 行内容</span></span><br><span class="line">tail -n 9 server.log</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 显示 server.log 内容，从 第 20 行至文件末尾</span> </span><br><span class="line"><span class="meta">#</span><span class="bash"> +20 表示从 第 20 行开始显示 -20 表示末尾 20 行开始显示 省略 -num 默认10</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> tail -n -5 filename 和 tail -n 5 显示的结果相同</span></span><br><span class="line">tail -n +20 server.log</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> -f 跟踪 server.log 文件内容</span></span><br><span class="line">tail -f server.log</span><br></pre></td></tr></table></figure>

<h3 id="head"><a href="#head" class="headerlink" title="head"></a>head</h3><p>head 命令可用于查看文件的开头部分的内容，有一个常用的参数 <strong>-n</strong> 用于显示行数，默认为 10，即显示 10 行的内容。</p>
<p><strong>参数：</strong></p>
<ol>
<li>-q 隐藏文件名</li>
<li>-v 显示文件名</li>
<li>-c &lt;数目&gt; 显示的字节数。</li>
<li>-n &lt;行数&gt; 显示的行数。</li>
</ol>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 显示文件开头10行</span></span><br><span class="line">head server.log</span><br><span class="line"><span class="meta">#</span><span class="bash"> 显示 开头5行</span></span><br><span class="line">head -n 5 server.log</span><br><span class="line"><span class="meta">#</span><span class="bash"> 显示 前20个字节</span></span><br><span class="line">head -c 20 server.log</span><br></pre></td></tr></table></figure>

<h3 id="grep"><a href="#grep" class="headerlink" title="grep"></a>grep</h3><p>Linux grep 命令用于查找文件里符合条件的字符串。</p>
<p>grep 指令用于查找内容包含指定的范本样式的文件，如果发现某文件的内容符合所指定的范本样式，预设 grep 指令会把含有范本样式的那一列显示出来。若不指定任何文件名称，或是所给予的文件名为 **-**，则 grep 指令会从标准输入设备读取数据。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 在当前目录中，查找后缀有 file 字样的且文件中包含 <span class="built_in">test</span> 字符串的文件，并打印出该字符串的行。</span></span><br><span class="line">grep test *file </span><br><span class="line"></span><br><span class="line">[root@iZbp1a8a1ba5rtv9pgdsuzZ ~]# cat testfile2</span><br><span class="line">this is test file2</span><br><span class="line">this is exile</span><br><span class="line">hello ins1mnia</span><br><span class="line">[root@iZbp1a8a1ba5rtv9pgdsuzZ ~]# cat testfile1</span><br><span class="line">this is a test file1</span><br><span class="line">this is ins1mnia</span><br><span class="line">hello</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查找 文件内容包含 <span class="built_in">test</span> 字符串 且 文件前缀以 <span class="built_in">test</span> 开头的文件，打印出有<span class="built_in">test</span>字符串的行</span></span><br><span class="line">[root@iZbp1a8a1ba5rtv9pgdsuzZ ~]# grep test test*</span><br><span class="line">testfile1:this is a test file1</span><br><span class="line">testfile2:this is test file2</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 反向查找 通过<span class="string">&quot;-v&quot;</span>参数可以打印出不符合条件行的内容</span></span><br><span class="line">grep -v test *test*</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 属于上面第二条的反向查找</span></span><br><span class="line">[root@iZbp1a8a1ba5rtv9pgdsuzZ ~]# grep -v test *test*</span><br><span class="line">testfile1:this is ins1mnia</span><br><span class="line">testfile1:hello</span><br><span class="line">testfile2:this is exile</span><br><span class="line">testfile2:hello ins1mnia</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查找 符合条件的日志条目 -n 或 --line-number : 在显示符合样式的那一行之前，标示出该行的列数编号。</span></span><br><span class="line">grep -n &#x27;2019-10-24 00:01:11&#x27; *.log</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">从文件内容查找与正则表达式匹配的行：</span></span><br><span class="line">grep –e &quot;正则表达式&quot; 文件名</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 递归找出 指定目录及其子目录下所有文件中包含<span class="string">&quot;update&quot;</span>的文件，并打印出该字符串所在行</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> -r 参数效果和指定<span class="string">&quot;-d recurse&quot;</span>参数相同</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> -d &lt;动作&gt; 当指定要查找的是目录而非文件时，必须使用这项参数，否则grep指令将回报信息并停止动作。比如 recurse 动作</span></span><br><span class="line">grep -r update /etc/acpi </span><br></pre></td></tr></table></figure>

<h3 id="find"><a href="#find" class="headerlink" title="find"></a>find</h3><p>Linux find 命令用来在指定目录下查找文件。<strong>任何位于参数之前的字符串都将被视为欲查找的目录名</strong>。如果使用该命令时，<strong>不设置任何参数</strong>，则 find 命令将在<strong>当前目录下查找子目录与文件</strong>。并且将查找到的子目录和文件全部进行显示。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 当前目录及其子目录下所有文件后缀为 .c 的文件列出来:</span></span><br><span class="line">find . -name &quot;*.c&quot;</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 将当前目录及其子目录中的所有文件列出：</span></span><br><span class="line">find . -type f</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 结合 grep 做筛选，筛选出前面中带有elasticsearch的文件</span></span><br><span class="line">find . -type f | grep elasticsearch</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 将当前目录及其子目录下所有最近 20 天内更新过的文件列出:</span></span><br><span class="line">find . -ctime  20</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">查找 /var/<span class="built_in">log</span> 目录中更改时间在 7 日以前的普通文件，并在删除之前询问它们：</span></span><br><span class="line">find /var/log -type f -mtime +7 -ok rm &#123;&#125; \;</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查找当前目录中文件属主具有读、写权限，并且文件所属组的用户和其他用户具有读权限的文件：</span></span><br><span class="line">find . -type f -perm 644 -exec ls -l &#123;&#125; \;</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查找系统中所有文件长度为 0 的普通文件，并列出它们的完整路径：</span></span><br><span class="line"> find / -type f -size 0 -exec ls -l &#123;&#125; \;</span><br></pre></td></tr></table></figure>

<p><strong>参数说明</strong> :</p>
<p>expression 常用部分</p>
<p>-amin n : 在过去 n 分钟内被读取过</p>
<p>-anewer file : 比文件 file 更晚被读取过的文件</p>
<p>-atime n : 在过去 n 天内被读取过的文件</p>
<p>-cmin n : 在过去 n 分钟内被修改过</p>
<p>-cnewer file :比文件 file 更新的文件</p>
<p>-ctime n : 在过去 n 天内创建的文件</p>
<p>-mtime n : 在过去 n 天内修改过的文件</p>
<p>-empty : 空的文件</p>
<p>-ipath p, -path p : 路径名称符合 p 的文件，ipath 会忽略大小写</p>
<p>-name name, -iname name : 文件名称符合 name 的文件。iname 会忽略大小写</p>
<p>-size n : 文件大小 是 n 单位，b 代表 512 位元组的区块，c 表示字元数，k 表示 kilo bytes，w 是二个位元组。</p>
<p>-type c : 文件类型是 c 的文件。</p>
<p>-type f：文件类型是 f (一般文件)的文件</p>
<p>d: 目录</p>
<p>f: 一般文件</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">ins1mnia</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://ins1mn1a.github.io/2022/09/20/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%8C%87%E4%BB%A4%E4%B8%8E%E9%9B%86%E7%BE%A4/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%8C%87%E4%BB%A4%E6%95%B4%E7%90%86/">http://ins1mn1a.github.io/2022/09/20/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%8C%87%E4%BB%A4%E4%B8%8E%E9%9B%86%E7%BE%A4/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%8C%87%E4%BB%A4%E6%95%B4%E7%90%86/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://ins1mn1a.github.io" target="_blank">ins1mn1a</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%8C%87%E4%BB%A4%E4%B8%8E%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA%E8%BF%87%E7%A8%8B/">中间件指令与集群搭建过程</a></div><div class="post_share"><div class="social-share" data-image="/img/background_img/1/1.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2022/09/20/JUC/%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BA%BF%E7%A8%8B%E6%B1%A0/"><img class="next-cover" src="/img/background_img/1/6.jpg" onerror="onerror=null;src='/img/background_img/error_page.jpeg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">自定义阻塞队列，线程池</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div id="comment-switch"><span class="first-comment">Valine</span><span class="switch-btn"></span><span class="second-comment">Disqus</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div><div><div id="disqus_thread"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://tvax1.sinaimg.cn/crop.0.0.996.996.180/007RWaeLly8gr7p82e9e6j30ro0rognd.jpg?KID=imgbed,tva&amp;Expires=1639625304&amp;ssig=yn%2FY%2BCtxLO" onerror="this.onerror=null;this.src='/img/background_img/error_page.jpeg'" alt="avatar"/></div><div class="author-info__name">ins1mnia</div><div class="author-info__description">because it feels like ins1mnia</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">35</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">14</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">13</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/ins1mnia"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/ins1mnia" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:ins1mnia@163.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">穿梭时间的画面的钟,从反方向开始移动</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Zookeeper"><span class="toc-number">1.</span> <span class="toc-text">Zookeeper</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Znode-%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="toc-number">1.1.</span> <span class="toc-text">Znode 基本操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Zookeeper-%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="toc-number">1.2.</span> <span class="toc-text">Zookeeper 基本操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Zookeeper-%E9%9B%86%E7%BE%A4"><span class="toc-number">1.3.</span> <span class="toc-text">Zookeeper 集群</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Redis"><span class="toc-number">2.</span> <span class="toc-text">Redis</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Redis-%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="toc-number">2.1.</span> <span class="toc-text">Redis 基本操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Redis-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E6%93%8D%E4%BD%9C"><span class="toc-number">2.2.</span> <span class="toc-text">Redis 数据类型操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Redis-key"><span class="toc-number">2.2.1.</span> <span class="toc-text">Redis key</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#String"><span class="toc-number">2.2.2.</span> <span class="toc-text">String</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#List"><span class="toc-number">2.2.3.</span> <span class="toc-text">List</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Set"><span class="toc-number">2.2.4.</span> <span class="toc-text">Set</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Hash"><span class="toc-number">2.2.5.</span> <span class="toc-text">Hash</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Zset"><span class="toc-number">2.2.6.</span> <span class="toc-text">Zset</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%89%E7%A7%8D%E7%89%B9%E6%AE%8A%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">2.2.7.</span> <span class="toc-text">三种特殊数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#geospatial"><span class="toc-number">2.2.7.1.</span> <span class="toc-text">geospatial</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Hyperloglog"><span class="toc-number">2.2.7.2.</span> <span class="toc-text">Hyperloglog</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Bitmap"><span class="toc-number">2.2.7.3.</span> <span class="toc-text">Bitmap</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Redis-%E9%9B%86%E7%BE%A4"><span class="toc-number">2.3.</span> <span class="toc-text">Redis 集群</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Kafka"><span class="toc-number">3.</span> <span class="toc-text">Kafka</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Kafka-%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="toc-number">3.1.</span> <span class="toc-text">Kafka 基本操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Kafka-%E9%9B%86%E7%BE%A4"><span class="toc-number">3.2.</span> <span class="toc-text">Kafka 集群</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Linux"><span class="toc-number">4.</span> <span class="toc-text">Linux</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#cat"><span class="toc-number">4.1.</span> <span class="toc-text">cat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#more"><span class="toc-number">4.2.</span> <span class="toc-text">more</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#less"><span class="toc-number">4.3.</span> <span class="toc-text">less</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tail"><span class="toc-number">4.4.</span> <span class="toc-text">tail</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#head"><span class="toc-number">4.5.</span> <span class="toc-text">head</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#grep"><span class="toc-number">4.6.</span> <span class="toc-text">grep</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#find"><span class="toc-number">4.7.</span> <span class="toc-text">find</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/09/20/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%8C%87%E4%BB%A4%E4%B8%8E%E9%9B%86%E7%BE%A4/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%8C%87%E4%BB%A4%E6%95%B4%E7%90%86/" title="Zookeeper、Redis、Kafka集群搭建指令与集群搭建过程"><img src="/img/background_img/1/1.jpg" onerror="this.onerror=null;this.src='/img/background_img/error_page.jpeg'" alt="Zookeeper、Redis、Kafka集群搭建指令与集群搭建过程"/></a><div class="content"><a class="title" href="/2022/09/20/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%8C%87%E4%BB%A4%E4%B8%8E%E9%9B%86%E7%BE%A4/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%8C%87%E4%BB%A4%E6%95%B4%E7%90%86/" title="Zookeeper、Redis、Kafka集群搭建指令与集群搭建过程">Zookeeper、Redis、Kafka集群搭建指令与集群搭建过程</a><time datetime="2022-09-20T04:44:31.833Z" title="发表于 2022-09-20 12:44:31">2022-09-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/09/20/JUC/%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BA%BF%E7%A8%8B%E6%B1%A0/" title="自定义阻塞队列，线程池"><img src="/img/background_img/1/6.jpg" onerror="this.onerror=null;this.src='/img/background_img/error_page.jpeg'" alt="自定义阻塞队列，线程池"/></a><div class="content"><a class="title" href="/2022/09/20/JUC/%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BA%BF%E7%A8%8B%E6%B1%A0/" title="自定义阻塞队列，线程池">自定义阻塞队列，线程池</a><time datetime="2022-09-20T04:31:26.322Z" title="发表于 2022-09-20 12:31:26">2022-09-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/27/%E7%AE%97%E6%B3%95/%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3/" title="滑动窗口"><img src="/img/background_img/1/2.jpg" onerror="this.onerror=null;this.src='/img/background_img/error_page.jpeg'" alt="滑动窗口"/></a><div class="content"><a class="title" href="/2022/07/27/%E7%AE%97%E6%B3%95/%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3/" title="滑动窗口">滑动窗口</a><time datetime="2022-07-27T14:57:22.561Z" title="发表于 2022-07-27 22:57:22">2022-07-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/27/ElasticSearch/ElasticSearch/" title="Elasticsearch"><img src="/img/background_img/1/8.jpg" onerror="this.onerror=null;this.src='/img/background_img/error_page.jpeg'" alt="Elasticsearch"/></a><div class="content"><a class="title" href="/2022/07/27/ElasticSearch/ElasticSearch/" title="Elasticsearch">Elasticsearch</a><time datetime="2022-07-27T14:48:59.392Z" title="发表于 2022-07-27 22:48:59">2022-07-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/27/Kafka/Kafka/" title="Kafka"><img src="/img/background_img/1/2.jpg" onerror="this.onerror=null;this.src='/img/background_img/error_page.jpeg'" alt="Kafka"/></a><div class="content"><a class="title" href="/2022/07/27/Kafka/Kafka/" title="Kafka">Kafka</a><time datetime="2022-07-27T14:46:17.266Z" title="发表于 2022-07-27 22:46:17">2022-07-27</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By ins1mnia</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">it feels like ins1mnia</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: '',
      appKey: '',
      placeholder: 'Please leave your footprints',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'en',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      path: window.location.pathname,
      requiredFields: ["nick,mail"],
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script>function loadDisqus () {
  var disqus_config = function () {
    this.page.url = 'http://ins1mn1a.github.io/2022/09/20/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%8C%87%E4%BB%A4%E4%B8%8E%E9%9B%86%E7%BE%A4/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%8C%87%E4%BB%A4%E6%95%B4%E7%90%86/'
    this.page.identifier = '2022/09/20/中间件指令与集群/中间件指令整理/'
    this.page.title = 'Zookeeper、Redis、Kafka集群搭建指令与集群搭建过程'
  };

  window.disqusReset = () => {
    DISQUS.reset({
      reload: true,
      config: disqus_config
    })
  }

  if (window.DISQUS) disqusReset()
  else {
    (function() { 
      var d = document, s = d.createElement('script');
      s.src = 'https://.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  }
}

if ('Valine' === 'Disqus' || !false) {
  if (false) btf.loadComment(document.getElementById('disqus_thread'), loadDisqus)
  else loadDisqus()
} else {
  function loadOtherComment () {
    loadDisqus()
  }
}
</script></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-show-text.min.js" data-mobile="false" data-text="you,are,you,are,my,favorite,medicine" data-fontsize="15px" data-random="false" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>